# Welcome Bot - Welcomes new contributors and issues
name: Welcome Bot

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]
  repository:
    types: [member_added]

permissions:
  issues: write
  pull-requests: write
  contents: read

jobs:
  welcome-new-issue:
    if: github.event_name == 'issues'
    runs-on: ubuntu-latest
    permissions:
      issues: write
      contents: read
    steps:
      - name: Welcome new issue
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.BOT_TOKEN }}
          script: |
            const { owner, repo, number } = context.issue;
            const issue = context.payload.issue;
            const user = issue.user.login;
            
            // Simple welcome message without first-issue check
            const comment = `👋 Welcome to Refactron, @${user}! Thanks for opening this issue.
            
            **Quick Links:**
            - 📖 [Documentation](https://github.com/Refactron-ai/Refactron_lib/blob/main/README.md)
            - 🤝 [Contributing Guide](https://github.com/Refactron-ai/Refactron_lib/blob/main/CONTRIBUTING.md)
            - 📋 [Code of Conduct](https://github.com/Refactron-ai/Refactron_lib/blob/main/CODE_OF_CONDUCT.md)
            
            **To help us help you:**
            - Make sure you've searched existing issues
            - Provide a clear description
            - Include steps to reproduce (if applicable)
            
            We'll review your issue and get back to you soon! 🚀`;
            
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number: number,
              body: comment
            });
            
            console.log(`Welcomed ${user} for issue #${number}`);

  welcome-new-pr:
    if: github.event_name == 'pull_request'
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: read
    steps:
      - name: Welcome new PR
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.BOT_TOKEN }}
          script: |
            const { owner, repo, number } = context.issue;
            const pr = context.payload.pull_request;
            const user = pr.user.login;
            
            // Simple welcome message without first-PR check
            const comment = `🎉 Thanks for contributing to Refactron, @${user}! We appreciate your effort.
            
            **Pre-merge checklist:**
            - [ ] Read our [Contributing Guide](https://github.com/Refactron-ai/Refactron_lib/blob/main/CONTRIBUTING.md)
            - [ ] Added tests for your changes
            - [ ] Updated documentation if needed
            - [ ] Ensured all tests pass
            - [ ] Followed our code style guidelines
            
            **Quick Links:**
            - 📖 [Documentation](https://github.com/Refactron-ai/Refactron_lib/blob/main/README.md)
            - 🤝 [Contributing Guide](https://github.com/Refactron-ai/Refactron_lib/blob/main/CONTRIBUTING.md)
            
            We'll review your PR and provide feedback soon! 🚀`;
            
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number: number,
              body: comment
            });
            
            console.log(`Welcomed ${user} for PR #${number}`);

  welcome-new-member:
    if: github.event_name == 'repository'
    runs-on: ubuntu-latest
    permissions:
      issues: write
      contents: read
    steps:
      - name: Welcome new member
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.BOT_TOKEN }}
          script: |
            const { owner, repo } = context.repo;
            const member = context.payload.member.login;
            
            // Create a welcome issue for new members
            const welcomeIssue = await github.rest.issues.create({
              owner,
              repo,
              title: `🎊 Welcome ${member} to the Refactron community!`,
              body: `# Welcome to Refactron! 🎉
              
              Hi @${member}! We're thrilled to have you join our community of developers working to eliminate technical debt and improve code quality.
              
              ## 🚀 Getting Started
              
              **Quick Links:**
              - 📖 [README](https://github.com/Refactron-ai/Refactron_lib/blob/main/README.md) - Project overview
              - 🚀 [Getting Started](https://github.com/Refactron-ai/Refactron_lib/blob/main/GETTING_STARTED_DEV.md) - Developer guide
              - 🤝 [Contributing](https://github.com/Refactron-ai/Refactron_lib/blob/main/CONTRIBUTING.md) - How to contribute
              - 📋 [Code of Conduct](https://github.com/Refactron-ai/Refactron_lib/blob/main/CODE_OF_CONDUCT.md) - Community guidelines
              
              ## 🎯 Ways to Contribute
              
              - 🐛 **Report bugs** - Help us find and fix issues
              - ✨ **Suggest features** - Share your ideas for improvement
              - 📝 **Improve documentation** - Help others understand the project
              - 🔧 **Fix issues** - Contribute code to solve problems
              - 🧪 **Add tests** - Improve code quality and reliability
              
              ## 🏷️ Good First Issues
              
              Look for issues labeled with:
              - \`good-first-issue\` - Perfect for newcomers
              - \`help-wanted\` - Community contributions needed
              - \`documentation\` - Documentation improvements
              - \`bug\` - Bug fixes
              
              ## 💬 Need Help?
              
              - 💬 **Discussions** - Ask questions in GitHub Discussions
              - 🐛 **Issues** - Report bugs or request features
              - 📧 **Contact** - Reach out to maintainers
              
              ## 🙏 Thank You
              
              Thank you for being part of our community! Together, we're making code better for everyone.
              
              ---
              
              *This welcome message was automatically generated. Feel free to close this issue once you're familiar with the project!*`,
              labels: ['welcome', 'community']
            });
            
            console.log(`Created welcome issue for new member ${member}: ${owner}/${repo}#${welcomeIssue.data.number}`);
